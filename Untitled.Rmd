---
title: "Breast Cancer Diagnosis"
output: pdf_document
---

```{r setup, echo = FALSE, warnings = FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(viridis)

knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## Data import & cleanness
```{r}
# Import data
breast_cancer = 
  read_csv("./data/breast-cancer.csv") %>% 
  janitor::clean_names() %>% 
  select(-c(1, 33)) %>% 
  mutate(diagnosis = as.factor(recode(diagnosis, `M` = 1, `B` = 0))) %>% 
  mutate_each_(funs(scale(.)), c(2:31))

# Standardize predictors
# Newton-Raphson Algorithm
pred_1 <- as.tibble(breast_cancer[2:11])
bc_scale1 <- as.matrix(cbind(rep(1, nrow(breast_cancer)), pred_1, breast_cancer$diagnosis))
names(bc_scale1) = c("intercept", names(breast_cancer)[2:11], "outcome")
  
# Coordinate-wise descending Algorithm
pred_2 <- as.tibble(breast_cancer[2:31])
bc_scale2 <- as.matrix(cbind(rep(1, nrow(breast_cancer)), pred_2, breast_cancer$diagnosis))
names(bc_scale1) = c("intercept", names(breast_cancer)[2:11], "outcome")
```


## Likelihood function, Gradient, and Hessian matrix
```{r}
# Compute likelihood function, gradient, and Hessian matrix
compute_stat <- function(dat, betavec){
  u <- dat[, -12] %*% betavec
  pi <- exp(u) / (1 + exp(u))
  # Log-likelihood at betavec
  loglik <- sum(dat$diagnosis * u - log(1 + exp(u)))
  # Gradient at betavec
  grad <- t(dat[, -12]) %*% (dat$diagnosis - pi)
  # Hessian at betavec
  hess <- -(pi * (1 - pi) * t(dat[, -12]) %*% dat[, -12])
  
  return(list(loglik = loglik, grad = grad, hess = hess))
}
```

```{r}
compute_stat(bc_scale1, betavec = as.vector(rep(1, 11)))
```

## Modified Newton-Raphson Algorithm
```{r}
# Comparsion to `glm` func
```


## Logistic-LASSO model
```{r}

```


## 5-fold CV
```{r}

```



